<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-post" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">廢文雜談 | 工程屍 FlyPie 的異想世界</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://flyskypie.github.io/posts/page/2"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:type" content="website"><meta data-rh="true" property="og:locale" content="zh_tw"><meta data-rh="true" property="og:title" content="廢文雜談 | 工程屍 FlyPie 的異想世界"><meta data-rh="true" name="description" content="Random post just like FB or Twitter."><meta data-rh="true" property="og:description" content="Random post just like FB or Twitter."><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><meta data-rh="true" property="og:image" content="https://raw.githubusercontent.com/FlySkyPie/flyskypie.github.io/main/post/2026-01-05_k8s-longhorn-install-and-helm/02_helm.webp"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://flyskypie.github.io/posts/page/2"><link data-rh="true" rel="alternate" href="https://flyskypie.github.io/posts/page/2" hreflang="en"><link data-rh="true" rel="alternate" href="https://flyskypie.github.io/posts/page/2" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="工程屍 FlyPie 的異想世界 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="工程屍 FlyPie 的異想世界 Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="工程屍 FlyPie 的異想世界 JSON Feed">




<link rel="alternate" type="application/rss+xml" href="/posts/rss.xml" title="工程屍 FlyPie 的異想世界 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/posts/atom.xml" title="工程屍 FlyPie 的異想世界 Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.4a9022c6.css">
<script src="/assets/js/runtime~main.f83208a8.js" defer="defer"></script>
<script src="/assets/js/main.422eb01f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_LBgp" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_RjML themedComponent--light_RyNI"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_RjML themedComponent--dark_ntqO"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs/the-key-of-huanche/">專案文件</a><a class="navbar__item navbar__link" href="/blogs">數位手記</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/posts">廢文雜談</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_s2nU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_DonJ colorModeToggle_KBLq"><button class="clean-btn toggleButton_qwn5 toggleButtonDisabled_tRn_" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_bYdl"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_D9Q4"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Cbrq"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_GUBX"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_UgN6 thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_PkUw margin-bottom--md">Recent posts</div><ul class="sidebarItemList_HFnO clean-list"><li class="sidebarItem_NmoJ"><a class="sidebarItemLink_GF4N" href="/posts/2026-02-26_storage-levels">_storage-levels</a></li><li class="sidebarItem_NmoJ"><a class="sidebarItemLink_GF4N" href="/posts/2026-02-25_anatomy-foot">解剖學 - 人體骨骼 - 學習筆記 - 足部</a></li><li class="sidebarItem_NmoJ"><a class="sidebarItemLink_GF4N" href="/posts/2026-02-25_homelabe-status">Homelab 遷移近況</a></li><li class="sidebarItem_NmoJ"><a class="sidebarItemLink_GF4N" href="/posts/2026-02-25_s3-migration">S3 遷移筆記</a></li><li class="sidebarItem_NmoJ"><a class="sidebarItemLink_GF4N" href="/posts/2026-02-23_superman">不對稱的紀律</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="前情提要"><header><h2 class="title_BVkY" itemprop="headline"><a itemprop="url" href="/posts/2026-01-22_zero123plus-intel-pytorch">XPU 運行 Zero123++ 筆  記 (Intel PyTorch)</a></h2><div class="container_sDB1 margin-vert--md"><time datetime="2026-01-22T00:00:00.000Z" itemprop="datePublished">January 22, 2026</time></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_SrKl"><div class="avatar margin-bottom--sm"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/9475660" alt="Wei Ji" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Wei Ji</span></a></div><small class="avatar__subtitle" itemprop="description">閃亮症候群工程屍</small></div></div></div></div></header><div class="markdown" itemprop="articleBody">
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="前情提要">前情提要<a href="#前情提要" class="hash-link" aria-label="Direct link to 前情提要" title="Direct link to 前情提要">​</a></h2>
<p><a href="https://github.com/SUDO-AI-3D/zero123plus" target="_blank" rel="noopener noreferrer">Zero123++</a> 是第一個我想要自己跑得模型，它是一個「多視圖重建」模型，通常作為 「2D image to 3D model」的前置處理。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/01_zero123plus-fae9d72604440c6ec795225077785d6e.webp" width="2560" height="1504" class="img_RpFt"></p>
<p>我對它有興趣有幾個原因，首先我對生成式 3D 模型有不小的興趣，對於獨立開發而言，經常使用基於 2D 的呈現方式，往往是受限於 3D 建模的成本高昂所致。</p>
<p>比起單純的文字提示詞生成，二維圖像生成三維模型具有有更高的可控性。在類神經模型領域，比起「one shot」我更喜歡將一個大問題切成數個小問題的方式，每個小問題都是單純的資料轉換  過程，讓整體算法具有更高的透明度，以及更為可控的行為。並且正如我提到的，Zero123++ 是整個 「2D image to 3D model」 資料流 (pipeline) 的一個關鍵環節。</p>
<p>從高維度的資料萃取特徵，或是轉換成其他低微度資料，是一個不那麼有趣的過程。反之，「多視圖重建」本質是一個提高資料維度任務，因此是一個不適定問題 (ill-posed problem)，不知道為什麼我對這類問題反而比較興奮（？）</p>
<p><img decoding="async" loading="lazy" src="/assets/images/02_wakuwaku-6cc867d0237ae2c01ebec9991a3af955.webp" width="750" height="500" class="img_RpFt"></p>
<p>至於為什麼要「自己跑」呢？因為這種需求算不上特別普遍，不像 LLM 已經有不少雲端供應商可以拿 API 直接打，這種野雞模型幾乎只能自己想辦法。</p>
<p>BUT，要運行 Zero123++ 需要大約 5GB 的 vRAM，我手上支援 CUDA 的外接 GPU 只有 4GB，這也是為什麼它是我「想自己跑」而不是「自己跑過」的模型...</p>
<p><img decoding="async" loading="lazy" src="/assets/images/03_vram-6c428a9d7437d4a07f60d2c1f210d3a7.webp" width="1200" height="675" class="img_RpFt"></p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="ram-就是-ram">RAM 就是 RAM<a href="#ram-就是-ram" class="hash-link" aria-label="Direct link to RAM 就是 RAM" title="Direct link to RAM 就是 RAM">​</a></h2>
<p>最近突然心想：</p>
<blockquote>
<p>vRAM 來 vRAM 去的，啊不然我的內顯也是顯卡唄，它有多少 vRAM？</p>
</blockquote>
<p>於是我試著下了個指令：</p>
<div class="language-shell codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-shell codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">$ glxinfo | grep -E -i &#x27;device|memory&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Device: Mesa Intel(R) Iris(R) Xe Graphics (RPL-P) (0xa7a0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Video memory: 23941MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Unified memory: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GL_AMD_performance_monitor, GL_AMD_pinned_memory, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GL_EXT_framebuffer_object, GL_EXT_framebuffer_sRGB, GL_EXT_memory_object, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GL_EXT_memory_object_fd, GL_EXT_packed_depth_stencil, GL_EXT_packed_float, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GL_AMD_pinned_memory, GL_AMD_query_buffer_object, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GL_EXT_gpu_program_parameters, GL_EXT_gpu_shader4, GL_EXT_memory_object, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GL_EXT_memory_object_fd, GL_EXT_multi_draw_arrays, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GL_EXT_instanced_arrays, GL_EXT_map_buffer_range, GL_EXT_memory_object, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GL_EXT_memory_object_fd, GL_EXT_multi_draw_arrays,</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>恩？我什麼時候 vRAM 自由了？</p>
<p>學習了一下才知道 GPU 和 RAM 之間有著頻寬限制，於是 Nvidia 乾脆把 RAM 塞進 GPU 內變成 vRAM，高度整合帶來的優勢就是速度提昇。</p>
<p>但是我不管啊，我就窮啊，要我等可以等啊，明明就有 RAM 卻不給我跑是怎樣？</p>
<p><img decoding="async" loading="lazy" src="/assets/images/04_ram-is-ram-e635e7da25f6ae75970df62619ed2e9f.webp" width="824" height="458" class="img_RpFt"></p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="zluda">ZLUDA<a href="#zluda" class="hash-link" aria-label="Direct link to ZLUDA" title="Direct link to ZLUDA">​</a></h2>
<p>當世界壟罩在 Nvidia 的 CUDA 的淫威（？）之下，我越想越覺得這個走向不太對勁，為什麼我想要跑個軟體需要被特定的硬體綁架？vRAM 不夠，請買更多？為什麼用低階設備跑的妥協不存在？</p>
<p>於是最近我其實默默的在蒐集「反 CUDA 對策」口袋清單：</p>
<ul>
<li><a href="https://github.com/jgbit/vuda" target="_blank" rel="noopener noreferrer">https://github.com/jgbit/vuda</a>
<ul>
<li>901 ⭐</li>
</ul>
</li>
<li><a href="https://github.com/vosen/ZLUDA" target="_blank" rel="noopener noreferrer">https://github.com/vosen/ZLUDA</a>
<ul>
<li>13.8k ⭐</li>
</ul>
</li>
</ul>
<p>VUDA 使用的是替換標頭檔的方式處理：</p>
<div class="language-cpp codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-cpp codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">if</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property expression function" style="color:#d73a49">defined</span><span class="token macro property expression punctuation" style="color:#393A34">(</span><span class="token macro property expression" style="color:#36acaa">__NVCC__</span><span class="token macro property expression punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;cuda_runtime.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&lt;vuda_runtime.hpp&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">endif</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>但是這在已經編譯、打包好的 Python 環境顯得不太有效。</p>
<p>反觀，ZLUDA 的處理方式就簡單的多：</p>
<div class="language-shell codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-shell codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">LD_LIBRARY_PATH=&quot;&lt;ZLUDA_DIRECTORY&gt;:$LD_LIBRARY_PATH&quot; &lt;APPLICATION&gt; &lt;APPLICATION_ARGUMENTS&gt;</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>也就是直接用實做了 CUDA 界面的動態函式庫直接替換真正的 CUDA。</p>
<p>不過實際試過之後發現不能如預期的運行，調查了  一下發現雖然 ZLUDA 自稱「CUDA on non-NVIDIA GPUs」，但是它的首要支援 (First class) 是 Windows + AMD。至於 Intel 嘛...翻來翻去才找到我要的解釋：</p>
<blockquote>
<p>Firstly, if you simply want those frameworks to run on an Intel GPUs, then ZLUDA might not be the best way. Deep Learning is quite high on the Intel priority list. Every major framework (certainly PyTorch, Tensorflow, MXNet, PaddlePaddle) has a dedicated team working on it to bring the best performance on CPU and GPU.
...
cuDNN API is really massive, it is a lot of work<sup><a href="#user-content-fn-zluda-pytorch-d0e8de" id="user-content-fnref-zluda-pytorch-d0e8de" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup></p>
</blockquote>
<p>這才知道 Intel 本身就有在這方面做一些努力，並且工作量也十分龐大，因此 ZLUDA 專案並不優先處理這方面 (Intel) 的需求。</p>
<p>加上 ZLUDA 專案本身跟 AMD 就走得比較近，底層實做也高度仰賴 ROCm <sup><a href="#user-content-fn-zluda-amd-d0e8de" id="user-content-fnref-zluda-amd-d0e8de" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup>。</p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="intel-extension-for-pytorch">Intel Extension for PyTorch<a href="#intel-extension-for-pytorch" class="hash-link" aria-label="Direct link to Intel Extension for PyTorch" title="Direct link to Intel Extension for PyTorch">​</a></h2>
<ul>
<li>Intel Extension for PyTorch<!-- -->
<ul>
<li>2k ⭐</li>
</ul>
</li>
</ul>
<p>有一些教學會說要安裝 oneAPI，一開始我也照做了，但是問題依然無法排除，直到我看到：</p>
<blockquote>
<p>When using torch-xpu from the PyTorch channel, <strong>you do not need to manually source your oneAPI environment</strong>. Instead, you can install it directly as follows:</p>
</blockquote>
<p>所以關於 oneAPI 的東西我這裡就不提了。</p>
<p>而 Intel 官方的安裝指引則是如下<sup><a href="#user-content-fn-intel-torch-install-d0e8de" id="user-content-fnref-intel-torch-install-d0e8de" data-footnote-ref="true" aria-describedby="footnote-label">3</a></sup>：</p>
<div class="language-shell codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-shell codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">python -m pip install torch==2.8.0 torchvision==0.23.0 torchaudio==2.8.0 --index-url https://download.pytorch.org/whl/xpu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python -m pip install intel-extension-for-pytorch==2.8.10+xpu --extra-index-url https://pytorch-extension.intel.com/release-whl/stable/xpu/us/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python -m pip install oneccl_bind_pt==2.8.0+xpu --index-url https://pytorch-extension.intel.com/release-whl/stable/xpu/us/</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>翻譯成 PDM 大概長這樣：</p>
<div class="language-toml codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-toml codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain"># pyproject.toml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dependencies = [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;torch==2.8.0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;torchvision==0.23.0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;torchaudio==2.8.0&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;intel-extension-for-pytorch==2.8.10+xpu&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;oneccl_bind_pt==2.8.0+xpu&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[tool.pdm.scripts]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start.cmd = &quot;python examples/img_to_mv.py&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start.env = { OverrideDefaultFP64Settings = &quot;1&quot;, IGC_EnableDPEmulation = &quot;1&quot; }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[[tool.pdm.source]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name = &quot;pytorch&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url = &quot;https://download.pytorch.org/whl/xpu&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">include_packages = [&quot;torch&quot;, &quot;torchvision&quot;, &quot;torchaudio&quot;, &quot;pytorch-triton-xpu&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exclude_packages = [&quot;*&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[[tool.pdm.source]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name = &quot;intel&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">url = &quot;https://pytorch-extension.intel.com/release-whl/stable/xpu/us/&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">include_packages = [&quot;intel-extension-for-pytorch&quot;, &quot;oneccl_bind_pt&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exclude_packages = [&quot;*&quot;]</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>這兩個環境變數則是用來修復 <code>UR error</code> 的問題<sup><a href="#user-content-fn-ur-error-d0e8de" id="user-content-fnref-ur-error-d0e8de" data-footnote-ref="true" aria-describedby="footnote-label">4</a></sup>：</p>
<div class="language-shell codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-shell codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">set OverrideDefaultFP64Settings=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">set IGC_EnableDPEmulation=1</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>最後成功花了 15 分鐘把這個：</p>
<p><img decoding="async" loading="lazy" src="data:image/webp;base64,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" width="256" height="256" class="img_RpFt"></p>
<p>變成這個：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/06_output-d847a67d4642c6a2f685a798ef3ed310.webp" width="640" height="960" class="img_RpFt"></p>
<section data-footnotes="true" class="footnotes"><h2 class="anchor anchorWithStickyNavbar_mpuI sr-only" id="footnote-label">Footnotes<a href="#footnote-label" class="hash-link" aria-label="Direct link to Footnotes" title="Direct link to Footnotes">​</a></h2>
<ol>
<li id="user-content-fn-zluda-pytorch-d0e8de">
<p>Any plans for testing this with Pytorch/Tensorflow/mxnet? · Issue #17 · vosen/ZLUDA. <a href="https://github.com/vosen/ZLUDA/issues/17" target="_blank" rel="noopener noreferrer">https://github.com/vosen/ZLUDA/issues/17</a> <a href="#user-content-fnref-zluda-pytorch-d0e8de" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-zluda-amd-d0e8de">
<p>讓 IntelAMD GPU 直接跑 CUDA 程式的 ZLUDA – Gea-Suan Lin&#x27;s BLOG. Retrieved 2026-01-22, from <a href="https://blog.gslin.org/archives/2024/02/13/11655/%E8%AE%93-intelamd-gpu-%E7%9B%B4%E6%8E%A5%E8%B7%91-cuda-%E7%A8%8B%E5%BC%8F%E7%9A%84-zluda/" target="_blank" rel="noopener noreferrer">https://blog.gslin.org/archives/2024/02/13/11655/%E8%AE%93-intelamd-gpu-%E7%9B%B4%E6%8E%A5%E8%B7%91-cuda-%E7%A8%8B%E5%BC%8F%E7%9A%84-zluda/</a> <a href="#user-content-fnref-zluda-amd-d0e8de" data-footnote-backref="" aria-label="Back to reference 2" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-intel-torch-install-d0e8de">
<p>Intel® Extension for PyTorch* Installation Guide. Retrieved 2026-01-22, from <a href="https://pytorch-extension.intel.com/installation" target="_blank" rel="noopener noreferrer">https://pytorch-extension.intel.com/installation</a> <a href="#user-content-fnref-intel-torch-install-d0e8de" data-footnote-backref="" aria-label="Back to reference 3" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-ur-error-d0e8de">
<p>RuntimeError: UR error on ADL-N with IPEX 2.5/2.6 using .to(torch.float16) · Issue #800 · intel/intel-extension-for-pytorch. <a href="https://github.com/intel/intel-extension-for-pytorch/issues/800#issuecomment-3166243912" target="_blank" rel="noopener noreferrer">https://github.com/intel/intel-extension-for-pytorch/issues/800#issuecomment-3166243912</a> <a href="#user-content-fnref-ur-error-d0e8de" data-footnote-backref="" aria-label="Back to reference 4" class="data-footnote-backref">↩</a></p>
</li>
</ol>
</section></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="試用了 Bifrost 大概九天，有很高的請求失敗率（~6%）："><header><h2 class="title_BVkY" itemprop="headline"><a itemprop="url" href="/posts/2026-01-18_bifrost">Bifrost 採坑筆記</a></h2><div class="container_sDB1 margin-vert--md"><time datetime="2026-01-18T00:00:00.000Z" itemprop="datePublished">January 18, 2026</time></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_SrKl"><div class="avatar margin-bottom--sm"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/9475660" alt="Wei Ji" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Wei Ji</span></a></div><small class="avatar__subtitle" itemprop="description">閃亮症候群工程屍</small></div></div></div></div></header><div class="markdown" itemprop="articleBody">
<p>試用了 Bifrost 大概九天，有很高的請求失敗率（~6%）：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/01_bifrost-6c4dc2fc719fc17599b35a84ae54680d.webp" width="1440" height="835" class="img_RpFt"></p>
<p>少數是可以透過修改應用層級的超時 (Timeout) 配置改善的，不過多數是實作本身的問題，預計下一個要嘗試的是 TensorZero ，不過在更換前先把 Bifrost 的問題紀錄一下。</p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="io-timeout"><code>i/o timeout</code><a href="#io-timeout" class="hash-link" aria-label="Direct link to io-timeout" title="Direct link to io-timeout">​</a></h2>
<p><img decoding="async" loading="lazy" src="data:image/webp;base64,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" width="629" height="258" class="img_RpFt"></p>
<p>這個 bug 看起來已經被紀錄在案一個月了，但是還沒有被修復：</p>
<p><a href="https://github.com/maximhq/bifrost/issues/1157" target="_blank" rel="noopener noreferrer">[Bug]: Getting I/O timeout · Issue #1157 · maximhq/bifrost</a></p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="websocket-異常">Websocket 異常<a href="#websocket-異常" class="hash-link" aria-label="Direct link to Websocket 異常" title="Direct link to Websocket 異常">​</a></h2>
<p>原本 Logs 頁面是會自動更新的，但是不知道為什麼不能正常運作，後台則有大量的錯誤訊息：</p>
<div class="codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-text codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">{&quot;level&quot;:&quot;error&quot;,&quot;time&quot;:&quot;2026-01-18T01:03:28Z&quot;,&quot;message&quot;:&quot;websocket upgrade error: websocket: request origin not allowed by FastHTTPUpgrader.CheckOrigin&quot;}</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_Wp5O padding--none margin-left--sm"><li class="tag_UXKs"><a class="tag_lXMw tagRegular_c460" href="/posts/tags/llm-observability">LLM Observability</a></li><li class="tag_UXKs"><a class="tag_lXMw tagRegular_c460" href="/posts/tags/llm-gateway">LLM Gateway</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="今天觀察到一個有趣的現象，紀錄一下。"><header><h2 class="title_BVkY" itemprop="headline"><a itemprop="url" href="/posts/2026-01-15_llm-observability">LLM 可觀測筆記</a></h2><div class="container_sDB1 margin-vert--md"><time datetime="2026-01-15T00:00:00.000Z" itemprop="datePublished">January 15, 2026</time></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_SrKl"><div class="avatar margin-bottom--sm"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/9475660" alt="Wei Ji" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Wei Ji</span></a></div><small class="avatar__subtitle" itemprop="description">閃亮症候群工程屍</small></div></div></div></div></header><div class="markdown" itemprop="articleBody">
<p>今天觀察到一個有趣的現象，紀錄一下。</p>
<p>原始請求：</p>
<div class="codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-text codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain"> You will have follow up questions. First, identify if your knowledge is outdated (high chance). Today: 2026-01-15. Generate 3 high-quality internet search questions to exactly answer: Which text structure is better for LLM prompts?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- Markdown based</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- XML based</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Consider the case with a task have multiple output, output blocks with XML tags seems is more reliable approach?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Language Rules:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Process the task in English (sort questions, search with English, search ranking...). </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Only final response (the task is doing Summary) with Chinese (zh_TW).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Format: One question per line, e.g. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Q: question1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Q: question2</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>LLM 的回答：</p>
<div class="codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-text codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">以下是三個高品質的搜尋問題，適用於查詢 Markdown 與 XML 在 LLM 提示語中的可靠性比較：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: Is XML-based prompt structure more reliable than Markdown for multi-output LLM tasks?  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: What are the advantages and disadvantages of Markdown-based vs XML-based prompt structures for large language models?  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: Does XML-based output formatting improve consistency and parsing reliability compared to Markdown in LLM prompts?</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>不過 OpenAI API 其實也會透露推理過程（Reasoning）：</p>
<div class="codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-text codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">We need to respond: &quot;You will have follow up questions. First, identify if your knowledge is outdated (high chance). Today: 2026-01-15. Generate 3 high-quality internet search questions to exactly answer: Which text structure is better for LLM prompts? - Markdown based - XML based Consider the case with a task have multiple output, output blocks with XML tags seems is more reliable approach? Language Rules: Process the task in English (sort questions, search with English, search ranking...). Only final response (the task is doing Summary) with Chinese (zh_TW). Format: One question per line, e.g. Q: question1 Q: question2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">We need to produce 3 search questions. They must be high-quality, for search queries. Probably something like: &quot;Is XML-based prompt structure more reliable than Markdown for multi-output LLM tasks?&quot; etc.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">We need to output only the final response with Chinese (zh_TW). That means the final output should be Chinese? But the questions themselves are in English. The instruction says: &quot;Only final response (the task is doing Summary) with Chinese (zh_TW).&quot; Wait. The user wants 3 high-quality internet search questions to exactly answer the query. But then the system says only final response with Chinese. That seems contradictory. The instructions: &quot;Only final response (the task is doing Summary) with Chinese (zh_TW).&quot; So the final response should be in Chinese. But the format: &quot;One question per line, e.g. Q: question1 Q: question2&quot;. That format presumably remains. But the content is in English? The user said &quot;Process the task in English (sort questions, search with English, search ranking...). Only final response (the task is doing Summary) with Chinese (zh_TW).&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">So we need to produce the final response in Chinese. But the questions themselves? The example shows &quot;Q: question1&quot; etc, presumably in English. But the final response should be in Chinese. Maybe we can write the questions in Chinese? But the instruction says &quot;Process the task in English&quot;. That might refer to sorting, search queries, etc. But the final output should be Chinese. So maybe we produce the questions in Chinese? Or we produce them in English but the final response is Chinese? The example is in English.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">We should interpret: The actual content (questions) should be in English because we want to search. But the final response (the entire output) should be in Chinese. So we can say:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: Is using XML tags for multi-output LLM prompts more reliable than using Markdown formatting? </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: What are the advantages and disadvantages of Markdown-based vs XML-based prompt structures for large language models? </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: In LLM prompt design, does XML-based output formatting improve consistency and parsing reliability compared to Markdown?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">But we must output this in Chinese. Maybe we can translate the entire set into Chinese? But then the search queries would be in Chinese, which might not be as effective for search. But the instruction says &quot;Process the task in English (sort questions, search with English, search ranking...). Only final response (the task is doing Summary) with Chinese (zh_TW).&quot; So perhaps the final response (the summary of the search queries) is in Chinese, but the queries themselves are listed in English.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Thus we produce:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: Is XML-based prompt structure more reliable than Markdown for multi-output LLM tasks?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">But maybe we need to phrase them as search queries. So maybe like:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: &quot;XML vs Markdown prompt structure reliability for multiple outputs in LLM&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: &quot;Advantages of XML tags in LLM prompt design over Markdown formatting&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: &quot;How does XML-based output block improve consistency and parsing for LLM prompts compared to Markdown&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">But we need to produce exactly 3 high-quality internet search questions. We&#x27;ll produce them as:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: &quot;Is XML-based prompt structure more reliable than Markdown for multi-output LLM tasks?&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: &quot;What are the advantages and disadvantages of Markdown-based vs XML-based prompt structures for large language models?&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: &quot;Does XML-based output formatting improve consistency and parsing reliability compared to Markdown in LLM prompts?&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Then we output in Chinese: &quot;以下是三個高品質的搜尋問題...&quot; But we need to follow the format: one question per line, prefixed with Q:. That format likely stays in English. But if we want to be consistent with instructions: &quot;Only final response (the task is doing Summary) with Chinese (zh_TW).&quot; So we might produce Chinese explanation and then the list of Q: lines in English. But the output must be Chinese. So maybe we can put the questions in Chinese too. But then they&#x27;d not be English search queries. The instruction: &quot;Process the task in English (sort questions, search with English, search ranking...). Only final response (the task is doing Summary) with Chinese (zh_TW).&quot; So we need to produce the final response in Chinese, but the search queries themselves can be in English. But we need to output them as part of the final response. The final response should be in Chinese, but we can include English lines. It&#x27;s ambiguous.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Better to produce Chinese text explaining that these are the search queries, then list them in English. That keeps final response Chinese. So:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">以下是三個高品質的搜尋問題，適用於查詢 Markdown 與 XML 在 LLM 提示語中的可靠性比較：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: Is XML-based prompt structure more reliable than Markdown for multi-output LLM tasks?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: What are the advantages and disadvantages of Markdown-based vs XML-based prompt structures for large language models?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Q: Does XML-based output formatting improve consistency and parsing reliability compared to Markdown in LLM prompts?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">We can do that. That satisfies the instructions.</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>But then the system says only final response with Chinese. That seems contradictory.</p>
</blockquote>
<p>指出當下的提示詞對 LLM 來說可能不夠直觀，Reasoning 的內容在一般的 LLM 應用程式基本上是不可見的，但是它似乎是調試提示詞的重要工具。</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_Wp5O padding--none margin-left--sm"><li class="tag_UXKs"><a class="tag_lXMw tagRegular_c460" href="/posts/tags/llm-observability">LLM Observability</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="今天 (2026-01-12) 處理了一些 YaCy 跟 SearXNG 的故障排除，做個紀錄。"><header><h2 class="title_BVkY" itemprop="headline"><a itemprop="url" href="/posts/2026-01-12_search-engine">自架搜尋引擎套餐 (YaCy + SearXNG + Local Deep Research)</a></h2><div class="container_sDB1 margin-vert--md"><time datetime="2026-01-12T00:00:00.000Z" itemprop="datePublished">January 12, 2026</time></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_SrKl"><div class="avatar margin-bottom--sm"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/9475660" alt="Wei Ji" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Wei Ji</span></a></div><small class="avatar__subtitle" itemprop="description">  閃亮症候群工程屍</small></div></div></div></div></header><div class="markdown" itemprop="articleBody">
<p>今天 (2026-01-12) 處理了一些 YaCy 跟 SearXNG 的故障排除，做個紀錄。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/00_cover-3c93848b192b398bc68fbf431b8908c8.webp" width="1320" height="600" class="img_RpFt"></p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="前情提要">前情提要<a href="#前情提要" class="hash-link" aria-label="Direct link to 前情提要" title="Direct link to 前情提要">​</a></h2>
<p>故事得從我最近愛用的 LLM 工具 LDR (<a href="https://github.com/LearningCircuit/local-deep-research" target="_blank" rel="noopener noreferrer">Local Deep Research</a>) 說起，LDR 能夠根據使用者的輸入拆分成數個 LLM 任務：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/01_local-deep-research-requests-68b55038b1b5be6ace8f9f5a9f7ee94c.webp" width="1191" height="309" class="img_RpFt"></p>
<p>其中一個任務長得像這樣：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/02_local-deep-research-task-ce78abea34956dad79bb826899acc988.webp" width="631" height="329" class="img_RpFt"></p>
<p>將使用者原始輸入轉換成精簡的搜尋引擎關鍵字之後，呼叫 <a href="https://github.com/searxng/searxng" target="_blank" rel="noopener noreferrer">SearXNG</a> 來取得搜尋結果。</p>
<p>SearXNG 本身不實做搜尋引擎，而是作為代理去呼叫多個搜尋引擎，諸如 Google, Bing, DuckDuckGo...</p>
<p><img decoding="async" loading="lazy" src="/assets/images/03_ldr-dependency-b88f787f7add166167f1a036e5c3c395.webp" width="1251" height="460" class="img_RpFt"></p>
<p>於是乎有時後會發生這種事情：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/04_search-error-04c944a86d78b1dce28146a1c4097c4f.webp" width="1171" height="312" class="img_RpFt"></p>
<p>呼叫太頻繁被外部的搜尋引擎封鎖，造成有的時候 LDR 會「研究失敗」，因為沒有可靠的外部資訊來源。</p>
<p>我架設 LDR 時使用官方的預設組態，沒有特別設定 SearXNG，於是想說趁這個機會改善這個問題。以上圖為例， 我被 Brave 搜尋引擎擋了。</p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="天下沒有白吃的午餐">天下沒有白吃的午餐<a href="#天下沒有白吃的午餐" class="hash-link" aria-label="Direct link to 天下沒有白吃的午餐" title="Direct link to 天下沒有白吃的午餐">​</a></h2>
<p>老實說我不會特別怪罪搜尋引擎投放廣告、過濾內容...，畢竟：</p>
<blockquote>
<p>當使用者沒有為服務付費，使用者本身就是產品，而不是消費者。</p>
</blockquote>
<p>搜尋引擎自己有自己的營利模型，而 SearXNG 的使用者幾乎就是繞過這些措施白嫖搜尋引擎，即便搜尋引擎供應商本身有它的原罪，我也不認為應該正當化白嫖的行為。</p>
<p>找來找去，<a href="https://github.com/yacy/yacy_search_server" target="_blank" rel="noopener noreferrer">YaCy</a> 似乎是比較合理的方案，它是一個去中心化的搜尋引擎，能夠透過 P2P (Peer-to-peer) 的方式分享索引資訊跟分散爬蟲任務。</p>
<p>網際網路巨大無比，只靠自己建立與維護索引資料根本癡心妄想，YaCy 在這方面就相對理想，讓一群人分散 Google 這種資訊巨獸才能建立的資料庫難度。</p>
<p>話雖如此，架設過程才發現要對外暴露埠才能對整個 YaCy 網路進行貢獻：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/05_yacy-error-98ccb5c1af8cbcc81e0098a214ac581f.webp" width="1154" height="201" class="img_RpFt"></p>
<p>目前我的 Homelab 出於安全性考慮是沒有對外暴露的，不過我依然可以在本地建立自己的索引資料庫，至於「做出貢獻」這件事大概要緩緩以後再來處理了。</p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="k8s-故障排除">K8s 故障排除<a href="#k8s-故障排除" class="hash-link" aria-label="Direct link to K8s 故障排除" title="Direct link to K8s 故障排除">​</a></h2>
<p>架設的過程有遇到一點問題，在這邊紀錄一下問題跟解決辦法。</p>
<div class="language-shell codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-shell codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl logs yacy-0 -n search-stack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">****************** YaCy Web Crawler/Indexer &amp; Search Engine *******************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**** (C) by Michael Peter Christen, usage granted under the GPL Version 2  ****</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">****   USE AT YOUR OWN RISK! Project home and releases: https://yacy.net/  ****</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**  LOG of       YaCy: DATA/LOG/yacy00.log (and yacy&lt;xx&gt;.log)                **</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**  STOP         YaCy: execute stopYACY.sh and wait some seconds             **</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">**  GET HELP for YaCy: join our community at https://community.searchlab.eu  **</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*******************************************************************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ YaCy v1.940 by Michael Christen / www.yacy.net ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jan 12, 2026 11:49:04 AM net.yacy.cora.util.ConcurrentLog enQueueLog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING: * could not create directories /opt/yacy_search_server/DATA/LOG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">could not copy yacy.logging: /opt/yacy_search_server/DATA/LOG/yacy.logging (No such file or directory)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">STARTUP: Trying to load logging configuration from file /opt/yacy_search_server/DATA/LOG/yacy.logging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">could not find logging properties in homePath=/opt/yacy_search_server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jan 12, 2026 11:49:04 AM net.yacy.cora.util.ConcurrentLog enQueueLog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WARNING: * java.io.FileNotFoundException: /opt/yacy_search_server/DATA/LOG/yacy.logging (No such file or directory)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.io.FileNotFoundException: /opt/yacy_search_server/DATA/LOG/yacy.logging (No such file or directory)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	at java.base/java.io.FileInputStream.open0(Native Method)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	at java.base/java.io.FileInputStream.open(Unknown Source)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	at java.base/java.io.FileInputStream.&lt;init&gt;(Unknown Source)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	at net.yacy.cora.util.ConcurrentLog.configureLogging(ConcurrentLog.java:385)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	at net.yacy.yacy.startup(yacy.java:180)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	at net.yacy.yacy.main(yacy.java:832)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jan 12, 2026 11:49:05 AM net.yacy.cora.util.ConcurrentLog enQueueLog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SEVERE: * FATAL ERROR: Permission denied</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">java.io.IOException: Permission denied</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	at java.base/java.io.UnixFileSystem.createFileExclusively0(Native Method)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	at java.base/java.io.UnixFileSystem.createFileExclusively(Unknown Source)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	at java.base/java.io.File.createNewFile(Unknown Source)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	at net.yacy.yacy.startup(yacy.java:194)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	at net.yacy.yacy.main(yacy.java:832)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Jan 12, 2026 11:49:05 AM net.yacy.cora.util.ConcurrentLog shutdown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: shutdown of ConcurrentLog.Worker void because it was not running.</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>典型的容器權限問題，在 K8s 可以透過 <code>securityContext</code> 處理：</p>
<div class="language-yaml codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-yaml codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">apiVersion</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> apps/v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">kind</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> StatefulSet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">template</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">securityContext</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">runAsUser</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">runAsGroup</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">fsGroup</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>但是該如何找到正確的 UID 和 GID 呢？OCI image 調查神器：<a href="https://github.com/wagoodman/dive" target="_blank" rel="noopener noreferrer">dive</a></p>
<p><img decoding="async" loading="lazy" src="/assets/images/06_dive-yacy-4380099a0d4e3e3bfa90e22d9938ab1f.webp" width="1440" height="853" class="img_RpFt"></p>
<p>SearXNG 也有類似的問題：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/07_dive-searxng-b0b27156137503e7901c23830e4ea805.webp" width="1440" height="859" class="img_RpFt"></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_Wp5O padding--none margin-left--sm"><li class="tag_UXKs"><a class="tag_lXMw tagRegular_c460" href="/posts/tags/homelab">homelab</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="其實自我架設 LLM 可觀測工具 (2025-10-05) 以後，陸續嘗試幾款 LLM 工具有獲得一些觀察，不過當時因為覺得缺乏嚴謹考證所以沒有發文，不過現在我可以說是往下一個階段前進了（？），大概也沒有做嚴謹實驗的計畫，就把當時的紀錄發出來水一篇廢文好了。"><header><h2 class="title_BVkY" itemprop="headline"><a itemprop="url" href="/posts/2026-01-08_llm-observability">LLM 可觀測筆記</a></h2><div class="container_sDB1 margin-vert--md"><time datetime="2026-01-08T00:00:00.000Z" itemprop="datePublished">January 8, 2026</time></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_SrKl"><div class="avatar margin-bottom--sm"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/9475660" alt="Wei Ji" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Wei Ji</span></a></div><small class="avatar__subtitle" itemprop="description">閃亮症候群工程屍</small></div></div></div></div></header><div class="markdown" itemprop="articleBody">
<p><img decoding="async" loading="lazy" src="/assets/images/00_cover-14435b79b73ad7d429eb4e7f1d68b5ff.webp" width="620" height="382" class="img_RpFt"></p>
<p>其實自<a href="https://flyskypie.github.io/posts/2025-10-05_llm-api-chain/" target="_blank" rel="noopener noreferrer">我架設 LLM 可觀測工具</a> (2025-10-05) 以後，陸續嘗試幾款 LLM 工具有獲得一些觀察，不過當時因為覺得缺乏嚴謹考證所以沒有發文，不過現在我可以說是往下一個階段前進了（？），大概也沒有做嚴謹實驗的計畫，就把當時的紀錄發出來水一篇廢文好了。</p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="llm-可觀測">LLM 可觀測<a href="#llm-可觀測" class="hash-link" aria-label="Direct link to LLM 可觀測" title="Direct link to LLM 可觀測">​</a></h2>
<p>這邊簡單跟不知道發生什麼事情的讀者解釋一下「LLM 可觀測」是什麼。以下容我重複使用以前做的圖卡：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/01_llm-observability-feb98d9f322cf06d99b2d63e51d3c6ff.webp" width="1080" height="1080" class="img_RpFt"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/02_llm-observability-967a0eaae4abe131c4d041952e44682b.webp" width="1080" height="1080" class="img_RpFt"></p>
<div class="theme-admonition theme-admonition-info admonition_a71W alert alert--info"><div class="admonitionHeading_ZphC"><span class="admonitionIcon_vqjX"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_fKWC"><p>「角色卡」是一種角色扮演類 LLM 應用軟體的資料包，本質上是包含一堆人物設定、世界觀設定、台詞樣板...的文字。</p></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/03_llm-observability-b6e151ba46fe9c05d4c17e0ac4b51592.webp" width="1080" height="1080" class="img_RpFt"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/04_llm-observability-9ac0c0eb44cc9b353fc5d9b84298da1d.webp" width="1080" height="1080" class="img_RpFt"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/05_llm-observability-0270b312ce9069c13e10e693304c4d10.webp" width="1080" height="1080" class="img_RpFt"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/06_llm-observability-12a537091b2b21eda7b56f3339555a30.webp" width="1080" height="1080" class="img_RpFt"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/07_llm-observability-f076524508fda25e403f6af549fc8336.webp" width="1080" height="1080" class="img_RpFt"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/08_llm-observability-a335d0a7f8fc4516572664588aa45f47.webp" width="1080" height="1080" class="img_RpFt"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/09_llm-observability-12fb6d23d84f4f46622a36dd51e4220a.webp" width="1080" height="1080" class="img_RpFt"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/10_llm-observability-6098d55e33ffed32118f540217ee4c78.webp" width="1080" height="1080" class="img_RpFt"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/11_llm-observability-bcf1a07fcccc5e234565accb11007c87.webp" width="1080" height="1080" class="img_RpFt"></p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="anythingllm">AnythingLLM<a href="#anythingllm" class="hash-link" aria-label="Direct link to AnythingLLM" title="Direct link to AnythingLLM">​</a></h2>
<p><a href="https://github.com/Mintplex-Labs/anything-llm" target="_blank" rel="noopener noreferrer">AnythingLLM</a> 是一個很熱門的 LLM 應用軟體。不過正如我前面所說的，LLM 只是一個組件，要讓它發揮效用，關鍵在於應用程式是否擷取正確資料或資訊餵給 LLM 處理，因此「應用程式的外部連線能力」是我測試的重點。</p>
<p>這是我的測試題目；我知道正確答案，而我也知道這個題目不簡單，我只是想觀察這些 LLM 應用軟體會怎麼處理這個任務：</p>
<blockquote>
<p>幫我搜尋這個專案的歷史</p>
<p><a href="https://github.com/ill-inc/biomes-game" target="_blank" rel="noopener noreferrer">https://github.com/ill-inc/biomes-game</a></p>
</blockquote>
<p>最後得到的結果當然不符合我的預期，於是我開啟我的可觀測工具檢查剛剛發生了什麼事情。</p>
<p>我們可以觀察到，AnythingLLM 根據我的輸入觸發了一個「網頁爬蟲工具」：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/12_anythingllm-322c94904b094a6a20209ef1a36a2a11.webp" width="1440" height="827" class="img_RpFt"></p>
<p>然後我們可以看到它單純從 GitHub 爬了一堆垃圾就開始唬爛我試著回答剛剛那個問題。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/13_anythingllm-06d1af67f4f6aa77e5df805f042a64c7.webp" width="1440" height="831" class="img_RpFt"></p>
<div class="theme-admonition theme-admonition-info admonition_a71W alert alert--info"><div class="admonitionHeading_ZphC"><span class="admonitionIcon_vqjX"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_fKWC"><p>正確答案是要用 <code>ill-inc</code> 找到 Global Illumination, Inc. 這間公司，接著找到 OpenAI 在 2023 年收購它們的新聞。
並且在專案的<a href="https://docs.biomes.gg/roadmap" target="_blank" rel="noopener noreferrer">文件網站</a>找到：「被收購之後，專案被團隊釋出後不再維護」的資訊。
我知道這個題目很難，所以後來我也沒有用這個題目測試了，加上我後來找到一些其他對於 LLM 軟體更重要的特性。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="perplexica">Perplexica<a href="#perplexica" class="hash-link" aria-label="Direct link to Perplexica" title="Direct link to Perplexica">​</a></h2>
<p><a href="https://github.com/ItzCrazyKns/Perplexica" target="_blank" rel="noopener noreferrer">Perplexica</a> 是一個自稱作為 Perplexity AI 開源替代方案的 LLM 軟體，Perplexity AI 則是一個以真實性為賣點的 SaaS (Software as a service)。</p>
<p>同一個題目，表現的跟 AnythingLLM 一樣差勁，不過除了外部連線的機制問題以外，我觀察到另外一個更可疑的行為：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/14_Perplexica-73d2856463931b9abbad70c26c2b97cf.webp" width="1440" height="833" class="img_RpFt"></p>
<p>它把對話紀錄的所有角色 (role) 都設定成 <code>assistant</code>！在 OpenAI API 的設計，role 至少有三種：<code>user</code>、<code>assistant</code>、<code>system</code>。</p>
<p>因此 LLM 實際上無法分辨歷史紀錄中誰說了什麼，因為全部都是 <code>assistant</code> 在自言自語。</p>
<p>實際上我在使用 google Gemini 的時候，很常發生：LLM 自己產生的某種結論 OOXX，在後續對話又說「正如你說的，OOXX」，把話塞到我嘴裡。我嚴重懷疑這是由類似的角色不分的提示詞工程造成的。</p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="local-deep-research">Local Deep Research<a href="#local-deep-research" class="hash-link" aria-label="Direct link to Local Deep Research" title="Direct link to Local Deep Research">​</a></h2>
<p><a href="https://github.com/LearningCircuit/local-deep-research" target="_blank" rel="noopener noreferrer">Local Deep Research</a> 是一個只有 3.8k 星星的專案（截至 2026-01-08），但是它嚴謹的特性深得我喜愛。</p>
<p>觀察到這個特性其實源自於一個意外，我搞錯搜尋引擎的設定，因此它當下無法使用搜尋引擎：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/15-local-deep-research-35d692bdd9e082eac8e0400538b08aed.webp" width="1440" height="835" class="img_RpFt"></p>
<p>但是我們看看它是怎麼回答使用者的：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/16-local-deep-research-69a309d7a0b0a1eeb0ff843113c53842.webp" width="1440" height="831" class="img_RpFt"></p>
<ul>
<li>它懂得回報使用者當下沒有對外連線、額外可供參考的資料，而不是直接試圖唬爛使用者。</li>
<li>這甚至是「光速是多少？」這種大部分 LLM 都可以應對的簡單問題。它也懂得自我檢討這個回答沒有參考資料佐證。</li>
<li>我使用的是普通的繼承 GPT 幹話王血統的 <code>openai/gpt-oss-20b</code>，並不是什麼特別調整的 LLM。</li>
</ul>
<p>我們可以看到它不像是其他 LLM 軟體直接把使用者輸入跟自己產生的資料填進去 OpenAI API 定義的對話紀錄裡面，而是紮紮實實的把任務切成多個 request 來處理：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/17-local-deep-research-1e77d5b7b569f49ee0decc5b7ff487c8.webp" width="1440" height="835" class="img_RpFt"></p>
<p>另外一個我在學習 VR 生態系時的例子，比對多個資料來源矛盾的敘述：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/18-local-deep-research-c54806eb5a9f2f27c973dac770ffed24.webp" width="1440" height="832" class="img_RpFt"></p>
<p>因此我可以簡單的把一些需要確認的主題丟給它研究，真正意義上的降低認知負荷，而不是時時要擔心 LLM 在唬爛 我：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/19-local-deep-research-d0c49f8deecfd6456b839347120308b8.webp" width="1440" height="833" class="img_RpFt"></p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="結論">結論<a href="#結論" class="hash-link" aria-label="Direct link to 結論" title="Direct link to 結論">​</a></h2>
<p>實際上提示詞工程跟正確的軟體架構可以有效處理 LLM 的「幻覺問題」，但是當今市場上的 LLM 軟體發展方向卻完全背道而馳：</p>
<ul>
<li>基於聊天形式的頁面設計，本質上是一個上下文極度不受控的環境，很容易讓 LLM 產生垃圾資料。</li>
<li>明明可以透過嚴謹的提示詞讓 LLM 做出更客觀的回應，但是大部分軟體都傾向取悅消費者，不斷的恭維跟唬爛使用者。</li>
<li>明明可以使用 one shot 的軟體形式提供更穩定的服務，但是就是要做成聊天機器人來欺騙投資人與使用者。</li>
</ul>
<p>就算不提閉源的 SaaS 方案（ChatGPT, Gemini...），AnythingLLM 或 Perplexica 這類譁眾取寵的實作反而贏得更多喝采（星星），而老實解決問題的 Local Deep Research 卻倍受冷落。</p>
<p>我用 LLM 可觀測性工具看見的不是邪惡的 LLM，更多的是整個產業帶有惡意的商業決策與人們的集體瘋狂。</p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="後記">後記<a href="#後記" class="hash-link" aria-label="Direct link to 後記" title="Direct link to 後記">​</a></h2>
<p>曾經有工程師問我，既然我想觀察提示詞工程，為什麼不乾脆看程式碼？畢竟那些自架軟體都有開源。</p>
<p>這是因為比起在可能不熟悉的程式語言裡探索、還要理解原始碼結構、最後早到提示詞模板跟相關實作，直接觀察界面簡單的多：</p>
<ul>
<li>當我送出一個指令，應用程式呼叫了幾次 LLM 來處理？<!-- -->
<ul>
<li>複雜問題但是只有一次呼叫，代表著實作的架構有問題。</li>
</ul>
</li>
<li>每次呼叫給了什麼輸入？<!-- -->
<ul>
<li>「Garbage in, garbage out」，如果 LLM 給了什麼糟糕的答案，十之八九來自應用程式給了糟糕的輸入。</li>
</ul>
</li>
</ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_Wp5O padding--none margin-left--sm"><li class="tag_UXKs"><a class="tag_lXMw tagRegular_c460" href="/posts/tags/llm-proxy">LLM Proxy</a></li><li class="tag_UXKs"><a class="tag_lXMw tagRegular_c460" href="/posts/tags/llm-gateway">LLM Gateway</a></li><li class="tag_UXKs"><a class="tag_lXMw tagRegular_c460" href="/posts/tags/llm-observability">LLM Observability</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="我在工作上通常會用 Emoji 代表「已讀」，包含我日常使用通訊軟體也有這個習慣，前一陣子 Discord 幫我的帳號做的年度總結剛好紀錄了我這個習慣："><header><h2 class="title_BVkY" itemprop="headline"><a itemprop="url" href="/posts/2026-01-07_emoji">工作哲學 - 已讀 Emoji</a></h2><div class="container_sDB1 margin-vert--md"><time datetime="2026-01-07T00:00:00.000Z" itemprop="datePublished">January 7, 2026</time></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_SrKl"><div class="avatar margin-bottom--sm"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/9475660" alt="Wei Ji" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Wei Ji</span></a></div><small class="avatar__subtitle" itemprop="description">閃亮症候群工程屍</small></div></div></div></div></header><div class="markdown" itemprop="articleBody">
<p>我在工作上通常會用 Emoji 代表「已讀」，包含我日常使用通訊軟體也有這個習慣，前一陣子 Discord 幫我的帳號做的年度總結剛好紀錄了我這個習慣：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/01_eye-emoji-cfea5a88cf364503bb41cd5905d209e3.webp" width="1440" height="919" class="img_RpFt"></p>
<p>G 胖 (Gabe Newell) 曾經對「遊戲的樂趣」做出<a href="https://www.youtube.com/watch?v=MGpFEv1-mAo" target="_blank" rel="noopener noreferrer">見解</a>：「遊戲環境應該對玩家的行為做出反應，所以當你射擊牆壁時，它因此留下了彈孔」。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/02_game-fun-b11c3281fc992cb7b0cddc69e1261ed9.webp" width="1058" height="630" class="img_RpFt"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/04_game-fun-68c624938b52a41dfa3e4fa4418d5275.webp" width="1058" height="623" class="img_RpFt"></p>
<p>因此我認為「代表已讀的 Emoji」就是對方訊息的彈孔，不要讓對方產生「訊息投入虛空之中」的挫折感。</p>
<p>從另外一個角度來看，職場是一個需要確定性、可靠性的環境，即時通訊軟體的溝通更是如此，這是一個關於 TCP/UDP 通訊協定的笑話：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/03_tcp-joke-aa84113a184e65c7824f98847afd1cc2.webp" width="802" height="928" class="img_RpFt"></p>
<p>在 TCP 通訊協定中，雙方需要多次的 ACK (Acknowledge)，確保封包有妥善送達而沒有遺失，如果有丟失的狀況就要重送來建立一個可靠的訊息交付管道；反觀 UDP 則是射後不理。</p>
<p>「代表已讀的 Emoji」就是一個 ACK，確保對方交待的事項你已經收到，並且開始承擔收到之後的責任。</p>
<p>你其實可以在無線電通訊觀察到類似的模式：「I COPY」「抄收」。</p></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="前情提要"><header><h2 class="title_BVkY" itemprop="headline"><a itemprop="url" href="/posts/2026-01-07_observability-outage">Homelab 可觀測重建進度</a></h2><div class="container_sDB1 margin-vert--md"><time datetime="2026-01-07T00:00:00.000Z" itemprop="datePublished">January 7, 2026</time></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_SrKl"><div class="avatar margin-bottom--sm"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/9475660" alt="Wei Ji" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Wei Ji</span></a></div><small class="avatar__subtitle" itemprop="description">閃亮症候群工程屍</small></div></div></div></div></header><div class="markdown" itemprop="articleBody">
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="前情提要">前情提要<a href="#前情提要" class="hash-link" aria-label="Direct link to 前情提要" title="Direct link to 前情提要">​</a></h2>
<div class="theme-admonition theme-admonition-info admonition_a71W alert alert--info"><div class="admonitionHeading_ZphC"><span class="admonitionIcon_vqjX"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_fKWC"><p>日期是根據 Git Commit 紀錄跟螢幕截圖時間推論的，但是不是真正精準的時間，因為 Git Commit 可能延後一段時間才推送，截圖的問題則是不是每一  個當下都有截圖。</p></div></div>
<p>2025-10-04 左右： LiteLLM 和 Langfuse 上線。
2025-10-11 左右： Local Deep Research 上線。</p>
<p>2025-10-14 左右： 開始比較頻繁使用 Local Deep Research。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/2025-10-14-191907-c54806eb5a9f2f27c973dac770ffed24.webp" width="1440" height="832" class="img_RpFt"></p>
<p>2025-10-22 左右：Homelab 開始出現當機異常。</p>
<ul>
<li>圖表的斷層就是伺服器完全當機讓資料採集的機能癱瘓造成的。</li>
<li>可以觀察到 CPU 跟 RAM 異常使用是 Langfuse 服務簇的 ClickHouse 造成的。</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/2025-10-22-153923-070d3dfe4225019fee6cc35f5bf10da4.webp" width="1440" height="833" class="img_RpFt"></p>
<p>2025-10-23 的紀錄：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/2025-10-23-092053-f2a15f06adb99d31dca02af023e74401.webp" width="1440" height="831" class="img_RpFt"></p>
<p><img decoding="async" loading="lazy" src="/assets/images/2025-10-23-092111-0bd35fe2f3c3b8d0692b25ac204ddb45.webp" width="1440" height="836" class="img_RpFt"></p>
<p>2025-11-01 左右：連帶 Grafana 服務簇也失效，失效後就把 Langfuse 關掉然後沒有修復它了，直到最近 (2026-01) 佈署 K8s 才準備把服務遷移過去。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/2025-11-01-201633-9c9e7938cab3d2f3ec6377040c98742f.webp" width="1440" height="830" class="img_RpFt"></p>
<p>Grafana 失效前我有關查到 Docker 在重新拉取 image，推測是因為我忘記鎖定 image 版本造成的。</p>
<hr>
<p>整個過程中出現過幾種不同的情況：</p>
<ul>
<li>電源鍵強制關機後恢復正常。</li>
<li>電源鍵強制關機後 LiteLLM 異常。<!-- -->
<ul>
<li>Stack 刪掉後重新佈署後恢復正常。</li>
</ul>
</li>
<li>電源鍵強制關機後 Langfuse 異常。<!-- -->
<ul>
<li>根據 clickhouse log 找到有問題的 block，刪除後重新佈  署恢復正常（如下）。</li>
</ul>
</li>
</ul>
<div class="codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-text codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">2025.11.01 11:00:20.208590 [ 652 ] {c14fc20e-f2b0-45cb-939c-0fe47de9811c::202510_16681_17212_76} &lt;Error&gt; virtual bool DB::MergePlainMergeTreeTask::executeStep(): Exception is in merge_task.: Code: 40. DB::Exception: Checksum doesn&#x27;t match: corrupted data. Reference: 52f594fc9d7f3ee0495f8f089d3882cf. Actual: c92bc03d0da25742da61b67ce5764aac. Size of compressed block: 3640. The mismatch is caused by single bit flip in data block at byte 2581, bit 2. This is most likely due to hardware failure. If you receive broken data over network and the error does not repeat every time, this can be caused by bad RAM on network interface controller or bad controller itself or bad RAM on network switches or bad CPU on network switches (look at the logs on related network switches; note that TCP checksums don&#x27;t help) or bad RAM on host (look at dmesg or kern.log for enormous amount of EDAC errors, ECC-related reports, Machine Check Exceptions, mcelog; note that ECC memory can fail if the number of errors is huge) or bad CPU on host. If you read data from disk, this can be caused by disk bit rot. This exception protects ClickHouse from data corruption due to hardware failures: While reading or decompressing /var/lib/clickhouse/store/c14/c14fc20e-f2b0-45cb-939c-0fe47de9811c/202510_16681_17060_75/data.bin (position: 824782, typename: DB::ReadBufferFromFilePReadWithDescriptorsCache, compressed data header: &lt;uninitialized&gt;): (while reading column ProfileEvent_ReadBufferFromFileDescriptorRead): (while reading from part /var/lib/clickhouse/store/c14/c14fc20e-f2b0-45cb-939c-0fe47de9811c/202510_16681_17060_75/ in table system.metric_log (c14fc20e-f2b0-45cb-939c-0fe47de9811c) located on disk default of type local, from mark 2 with max_rows_to_read = 916, offset = 0): While executing MergeTreeSequentialSource. (CHECKSUM_DOESNT_MATCH), Stack trace (when copying this message, always include the lines below):</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p>電源鍵強制關機後 Langfuse 異常。</p>
<ul>
<li>根據 clickhouse log 找到有問題的 block，刪除後重新佈署依然無法恢復。</li>
<li>把 clickhouse 建立全新的 Volume 後恢復正常。</li>
</ul>
</li>
<li>
<p>有幾次伺服器是完全沒螢幕反應，有反應的幾次可以在終端觀察到 CPU Lock：</p>
</li>
</ul>
<div class="codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-text codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">watchdog: BUG: soft lockup - CPU#* stuck for **s!</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="仰賴鏈">仰賴鏈<a href="#仰賴鏈" class="hash-link" aria-label="Direct link to 仰賴鏈" title="Direct link to 仰賴鏈">​</a></h2>
<p><img decoding="async" loading="lazy" src="/assets/images/02_dependencies-d48e34f6da96e43bd203ab5d2780b64d.webp" width="1072" height="638" class="img_RpFt"></p>
<ol>
<li>Biomes 重構的進展目前面臨大量的 Schema 型別修復工作，我需要借助 LLM 之力來解決。</li>
</ol>
<p><img decoding="async" loading="lazy" src="/assets/images/01_shared-build-errors-502be1013e64f362bd01b74967d4b8e6.webp" width="1421" height="776" class="img_RpFt"></p>
<ol start="2">
<li>我拒絕使用基於聊天或 IDE Agent 的 LLM 方案。</li>
<li>我想使用 ComfyUI 來構造專門用來處理 Schema 修復問題的 pipeline。</li>
<li>我在本地使用 LLM 工具我要求必須在有 LLM Observability 的前提下使用，所以我必須先修復我的 LLM Observability。</li>
<li>在有伺服器崩潰的前車之鑑，我要求必須在有 Observability 的前提下佈署 LLM Observability，所以我必須先修復我的 Observability。</li>
<li>但是我不想在現有的節點上修復 Observability，而是在新的節點使用 K8s 並佈署 Observability，因此我要先學習使用 K8s。</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="observability-重建的當前狀態">Observability 重建的當前狀態<a href="#observability-重建的當前狀態" class="hash-link" aria-label="Direct link to Observability 重建的當前狀態" title="Direct link to Observability 重建的當前狀態">​</a></h2>
<p>到昨天 (2026-01-06) 為止，我已經：</p>
<ol>
<li>設定新的節點，安裝 K3s。(2025-12-24)<!-- -->
<ul>
<li><a href="https://flyskypie.github.io/posts/2026-01-03_laptop-homelab/" target="_blank" rel="noopener noreferrer">筆記型 Homelab 飼養注意事項</a></li>
<li><a href="https://flyskypie.github.io/posts/2026-01-02_learn-k8s/" target="_blank" rel="noopener noreferrer">安裝 K3s 與遠端連線</a></li>
</ul>
</li>
<li>整理之前跟 K8s 有關的知識點。(2025-12-28~2026-01-02)<!-- -->
<ul>
<li><a href="https://flyskypie.github.io/posts/2025-12-28_learn-k8s/" target="_blank" rel="noopener noreferrer">教練我想學 K8s</a></li>
<li><a href="https://flyskypie.github.io/posts/2025-12-29_systemd-ish/" target="_blank" rel="noopener noreferrer">從 Docker 開始的 Systemd 小宇宙</a></li>
<li><a href="https://flyskypie.github.io/posts/2025-12-31_learn-k8s/" target="_blank" rel="noopener noreferrer">K8s 學習筆記 - Cluster 和它快樂的小夥伴們</a></li>
<li><a href="https://flyskypie.github.io/posts/2026-01-01_learn-k8s/" target="_blank" rel="noopener noreferrer">K8s 學習筆記 - Pod 和它快樂的小夥伴們</a></li>
</ul>
</li>
<li>釐清 Ingress/Load Balancer 的概念。(~2026-01-05)<!-- -->
<ul>
<li><a href="https://flyskypie.github.io/posts/2026-01-05_k8s-is-framework/" target="_blank" rel="noopener noreferrer">K8s 學習筆記 - K8s 只是框架</a></li>
</ul>
</li>
<li>釐清 PV/PVC 的概念。(~2026-01-05)</li>
<li>用 Helm 安裝 Longhorn。(2026-01-05)<!-- -->
<ul>
<li><a href="https://flyskypie.github.io/posts/2026-01-05_k8s-longhorn-intro/" target="_blank" rel="noopener noreferrer">K8s 學習筆記 - Longhorn 簡介</a></li>
<li><a href="https://flyskypie.github.io/posts/2026-01-05_k8s-longhorn-install-and-helm/" target="_blank" rel="noopener noreferrer">K8s 學習筆記 - Longhorn 安裝與 Helm</a></li>
</ul>
</li>
<li>用 Helm 安裝 Kube-Prometheus-Stack。(2026-01-06)</li>
</ol>
<hr>
<p><img decoding="async" loading="lazy" src="/assets/images/03_migration-b30fe59a52f586312ec687216542c11b.webp" width="1578" height="772" class="img_RpFt"></p>
<p>用 K8s 內的 Prometheus 和 Grafana 實例取代原本的，原本的兩張 Dashboard 則是本來就有 JSON 檔直接移過去。原本的伺服器指保留 Cadvisor 供新的 Prometheus 採集資料。</p>
<p>目前關於容器的 Dashboard 是處於兩個節點資料混在一起的狀態，暫時先不處理 Query 需要更新的問題：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-07-110633-75db9d2164912febd853c6d9d896dc67.webp" width="1440" height="836" class="img_RpFt"></p>
<p>Node Dashboard 則是直接接軌新的 Node Exporter 的資料，暫時也先不處理舊節點的資料：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/2026-01-07-125235-b3a4c6e35bbcb101d9d265977d9db27e.webp" width="1440" height="831" class="img_RpFt"></p>
<div class="theme-admonition theme-admonition-info admonition_a71W alert alert--info"><div class="admonitionHeading_ZphC"><span class="admonitionIcon_vqjX"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_fKWC"><p>Kube-Prometheus-Stack 其實有提供不少 Dashboard 用來觀察新節點，我就不在這邊一一列舉了。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="prometheus-安裝筆記">Prometheus 安裝筆記<a href="#prometheus-安裝筆記" class="hash-link" aria-label="Direct link to Prometheus 安裝筆記" title="Direct link to Prometheus 安裝筆記">​</a></h2>
<p>跟 Longhorn 一樣直接使用 Helm 安裝：</p>
<div class="language-shell codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-shell codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo add prometheus-community https://prometheus-community.github.io/helm-charts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm show values prometheus-community/kube-prometheus-stack --version 51.6.0 &gt;values.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install prometheus-stack prometheus-community/kube-prometheus-stack \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -f values.yaml \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -n prometheus-stack \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --create-namespace \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --version 51.6.0</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>values.yaml</code> 倒是有做一些調整：</p>
<ul>
<li>時區</li>
<li>適應當前 K8s (K3s) 的 Ingress 為 Traefik</li>
<li>對內網 DNS 暴露 Grafana</li>
<li>適應當前 K8s 持久化實例為 Longhorn</li>
<li>從舊 Node 的 Cadvisor 採集資料</li>
</ul>
<div class="language-yaml codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-yaml codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">grafana</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">defaultDashboardsTimezone</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> Asia/Taipei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">ingress</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ingressClassName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> traefik</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">hosts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> grafana.observable.gas.arachne</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">prometheus</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">prometheusSpec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">storageSpec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">volumeClaimTemplate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">spec</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">storageClassName</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> longhorn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">accessModes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;ReadWriteOnce&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token key atrule" style="color:#00a4db">resources</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token key atrule" style="color:#00a4db">requests</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token key atrule" style="color:#00a4db">storage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 50Gi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">additionalScrapeConfigs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token scalar string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">      - job_name: beta-cadvisor</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">        static_configs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">          - targets:</span><br></span><span class="token-line" style="color:#393A34"><span class="token scalar string" style="color:#e3116c">            - web.cadvisor.arachne</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="llm-observability-重建的當前狀態">LLM Observability 重建的當前狀態<a href="#llm-observability-重建的當前狀態" class="hash-link" aria-label="Direct link to LLM Observability 重建的當前狀態" title="Direct link to LLM Observability 重建的當前狀態">​</a></h2>
<p>LiteLLM 雖然在 OpenRouter 排行榜蟬聯前幾名，但是實際使用下來給我的感覺不太穩定（經歷過加密 Bug、當機後無法正常復位）。</p>
<p>另一方面，Langfuse 給我的感覺則是相對肥大（服務簇需要同時配置 ClickHouse、MinIO、Redis、PostgresSQL），但是我又沒有使用到裡面的每一個功能。更別提 ClickHouse 就是表面上這次事故的主因。</p>
<p>因此我打算評估其他 LLM Gateway/Observability 方案，目前看上 <a href="https://github.com/maximhq/bifrost" target="_blank" rel="noopener noreferrer">Bifrost</a>，試用了一下感覺不錯，就是它的資料庫配置稍微有點麻煩，這個部份可能之後再提。</p></div></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="K8s 不是一個完整解決方案，K8s 只是框架。"><header><h2 class="title_BVkY" itemprop="headline"><a itemprop="url" href="/posts/2026-01-05_k8s-is-framework">K8s 學習筆記 - K8s 只是框架</a></h2><div class="container_sDB1 margin-vert--md"><time datetime="2026-01-05T00:00:00.000Z" itemprop="datePublished">January 5, 2026</time></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_SrKl"><div class="avatar margin-bottom--sm"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/9475660" alt="Wei Ji" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Wei Ji</span></a></div><small class="avatar__subtitle" itemprop="description">閃亮症候群工程屍</small></div></div></div></div></header><div class="markdown" itemprop="articleBody">
<blockquote>
<p>K8s 不是一個完整解決方案，K8s 只是框架。</p>
</blockquote>
<p>驚不驚喜？意不意外？</p>
<p>當你安裝了 Docker 之後就可以開始打包 image 並運行程式，甚至可以使用 Dokcer Compose 指令開始進行容器編排 (Orchestration)。</p>
<p>反觀，對於一個 K8s 使用者而言，生態系內有很多「口味」供你選擇：Minikube、MicroK8s、K3s、GKE、EKS...但是當你選擇原味 (Vanilla)時，你可能會發現歷經一番波折安裝完成之後，你還是什麼都不能幹：不能正常建立網路連線、不能正常的掛載持久化實體 (Volume)...</p>
<p>為什麼？因為 K8s 本身不是開箱即用解決方案，它只是一種框架。</p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="不是開箱即用的網路">不是開箱即用的網路<a href="#不是開箱即用的網路" class="hash-link" aria-label="Direct link to 不是開箱即用的網路" title="Direct link to 不是開箱即用的網路">​</a></h2>
<div class="theme-admonition theme-admonition-info admonition_a71W alert alert--info"><div class="admonitionHeading_ZphC"><span class="admonitionIcon_vqjX"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_fKWC"><p>這個段落會多次提及 OSI 的 L4 和 L7，對兩者差異不清楚的讀者建議先去查點資料，不然閱讀起來可能會有點吃力。</p></div></div>
<p>我在<a href="https://flyskypie.github.io/posts/2026-01-01_learn-k8s/" target="_blank" rel="noopener noreferrer">前一篇文章</a>中介紹了 Service，以及內網模式 ClusterIP 與節點開埠 NodePort，即便是 NodePort 也不像是標準佈署使用的模式，因為它只能開奇怪的埠號。這是因為 Service 其實還有兩個生產環境在使用的模式：LoadBalancer 模式或是加掛一個 Ingress。</p>
<p>以 ServiceLB (LoadBalancer) 為例，K8s 只提供一個 L4 的抽象層，具體的實做依然需要別人來完成：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/01_lb-controller-9a70bb19a4e58307ba30e54f7e361770.webp" width="917" height="458" class="img_RpFt"></p>
<div class="theme-admonition theme-admonition-info admonition_a71W alert alert--info"><div class="admonitionHeading_ZphC"><span class="admonitionIcon_vqjX"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_fKWC"><p>LB (LoadBalancer) Controller 是一個方便讀者理解的稱呼，實際情況比較複雜，有其他專門的術語用來稱呼這個東西。</p></div></div>
<p>在雲端環境（如 Google, AWS）這是由雲端供應商實作的，可能是一團閉源商業軟體和硬體級 LB 整合而成；在 K3s 中這是由 <a href="https://github.com/k3s-io/klipper-lb" target="_blank" rel="noopener noreferrer">klipper-lb</a> 透過 <code>hostPort</code> 實作的。</p>
<p>Ingress 也是相同的狀況，K8s 只提供一個 L7 的抽象層，具體的實做依然需要別人來完成：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/02_ingress-controller-b0104efe4f8fed322b5ed08be65ff649.webp" width="1224" height="447" class="img_RpFt"></p>
<p>實作可以是 Nginx 也可以是 Traefik。</p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="不是開箱即用的持久化儲存">不是開箱即用的持久化儲存<a href="#不是開箱即用的持久化儲存" class="hash-link" aria-label="Direct link to 不是開箱即用的持久化儲存" title="Direct link to 不是開箱即用的持久化儲存">​</a></h2>
<p>K8s 在設計上就是一個分散式運行的框架，當 Pod 可能分散在多個不同的主機（節點）時，我們就不能像 Docker 那樣直接用某個路徑當作持久化實體。</p>
<p>在 K8s 的世界中，Volume 通常是一個 SDS (Software-defined storage)；
在 K8s 的世界中，網路線就是 SATA 線。</p>
<p>細節我不在此解釋，簡單來說在 K8s 要幫 Container 掛載 Volume 需要經過層層抽象，並且最後實際的儲存實體並不在 K8s 內實作：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/03_storage-backend-e7a9cba39ddcedd48bddc96779f8936b.webp" width="1089" height="715" class="img_RpFt"></p>
<div class="theme-admonition theme-admonition-info admonition_a71W alert alert--info"><div class="admonitionHeading_ZphC"><span class="admonitionIcon_vqjX"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_fKWC"><p>你也可以在 K8s 設定 <code>storageClassName: local-storage</code> 的 Volume，但是這樣你可能需要額外配置讓 Pod 只能佈署在特定的 Node 上。</p></div></div>
<div class="theme-admonition theme-admonition-info admonition_a71W alert alert--info"><div class="admonitionHeading_ZphC"><span class="admonitionIcon_vqjX"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_fKWC"><p>Storage Backend 同樣是一個方便讀者理解的稱呼，並不是 K8s 內的標準術語。</p></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_Wp5O padding--none margin-left--sm"><li class="tag_UXKs"><a class="tag_lXMw tagRegular_c460" href="/posts/tags/k-8-s">k8s</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Longhorn 可以用很多方式安裝，包含最基本的 kubectl 指令："><header><h2 class="title_BVkY" itemprop="headline"><a itemprop="url" href="/posts/2026-01-05_k8s-longhorn-install-and-helm">K8s 學習筆記 - Longhorn 安裝與 Helm</a></h2><div class="container_sDB1 margin-vert--md"><time datetime="2026-01-05T00:00:00.000Z" itemprop="datePublished">January 5, 2026</time></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_SrKl"><div class="avatar margin-bottom--sm"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/9475660" alt="Wei Ji" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Wei Ji</span></a></div><small class="avatar__subtitle" itemprop="description">閃亮症候群工程屍</small></div></div></div></div></header><div class="markdown" itemprop="articleBody">
<p>Longhorn 可以用很多方式安裝，包含最基本的 <code>kubectl</code> 指令：</p>
<div class="language-shell codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-shell codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/longhorn/longhorn/v1.10.1/deploy/longhorn.yaml</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>不過等等！不要急著下指令！讓我們瞄一眼裡面有些什麼：</p>
<div class="language-shell codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-shell codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">wget https://raw.githubusercontent.com/longhorn/longhorn/v1.10.1/deploy/longhorn.yaml</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/01_longhorn-install-yaml-1f7ad17473887f8aa9a4cda144d179b1.webp" width="521" height="589" class="img_RpFt"></p>
<p>是的，這是一個有四千多行的 YAML，善於偷懶的聰明開發者們當然不會想直接跟這團東西打交道。</p>
<div class="theme-admonition theme-admonition-info admonition_a71W alert alert--info"><div class="admonitionHeading_ZphC"><span class="admonitionIcon_vqjX"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_fKWC"><p>這個數字可以當作一個參考，一個完整的雲原生軟體佈署到 K8s 需要的聲明的資訊大概會達到這個量體。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="helm">Helm<a href="#helm" class="hash-link" aria-label="Direct link to Helm" title="Direct link to Helm">​</a></h2>
<p><img decoding="async" loading="lazy" src="/assets/images/02_helm-4306e187254cfeaddb4fbe25fa2d74ca.webp" width="1859" height="1035" class="img_RpFt"></p>
<p>就像 Longhorn 需要四千多行的 YAML 一樣，還有許許多多的雲原生應用軟體實際都是由大量的 K8s 資源或實體交錯編排而成，於是就有了 Helm 這個工具的誕生：一個 K8s 世界的 APT (Advanced Packaging Tool)。</p>
<p>在 Helm 的世界，這一堆聲明的 YAML 被包裝成一個稱作 Chart 的東西，「安裝」(佈署應用程式到 K8s)大概像這樣：</p>
<div class="language-shell codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-shell codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo add longhorn https://charts.longhorn.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install longhorn longhorn/longhorn \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --namespace longhorn-system \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --create-namespace \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --version 1.10.1</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Helm 還有另外一個重要的功能：對 Chart 傳入變數，也是今天我要使用 Helm 的主要原因。</p>
<h2 class="anchor anchorWithStickyNavbar_mpuI" id="用-helm-安裝-longhorn">用 Helm 安裝 Longhorn<a href="#用-helm-安裝-longhorn" class="hash-link" aria-label="Direct link to 用 Helm 安裝 Longhorn" title="Direct link to 用 Helm 安裝 Longhorn">​</a></h2>
<div class="theme-admonition theme-admonition-info admonition_a71W alert alert--info"><div class="admonitionHeading_ZphC"><span class="admonitionIcon_vqjX"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_fKWC"><p>這個段落的內容主要參考 Longhorn 的官方文件<sup><a href="#user-content-fn-longhorn-config-6a8af0" id="user-content-fnref-longhorn-config-6a8af0" data-footnote-ref="true" aria-describedby="footnote-label">1</a></sup>。</p></div></div>
<p>首先下載參數檔：</p>
<div class="language-shell codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-shell codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">curl -Lo values.yaml https://raw.githubusercontent.com/longhorn/longhorn/refs/tags/v1.10.1/chart/values.yaml</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>根據需求修改 <code>values.yaml</code>，以我目前的需求為例，分別是：</p>
<ul>
<li>持久化須儲存到外部 DAS 的掛載點。</li>
<li>目前只有一個工作節點，所以副本只有一份。</li>
</ul>
<div class="language-yaml codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-yaml codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">defaultSettings</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">defaultDataPath</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> /mnt/das</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">storage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">defaultReplicaCount</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>安裝 Longhorn 到 K8s：</p>
<div class="language-shell codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-shell codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">helm install longhorn longhorn/longhorn \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --namespace longhorn-system \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --create-namespace \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --version 1.10.1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --values values.yaml</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>拉取 Image 需要時間，過程中可以使用指令檢查是不是所有 Pod 已經就位：</p>
<div class="language-shell codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-shell codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">$ kubectl -n longhorn-system get pod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                                        READY   STATUS              RESTARTS      AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">engine-image-ei-3154f3aa-tsq6p              0/1     ContainerCreating   0             23s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">longhorn-driver-deployer-58768fb7fd-ktpq8   1/1     Running             0             2m58s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">longhorn-manager-bsqms                      2/2     Running             2 (44s ago)   2m58s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">longhorn-ui-7b9c99fd9-j8bxb                 1/1     Running             0             2m58s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">longhorn-ui-7b9c99fd9-w2l6b                 1/1     Running             0             2m58s</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>執行 Tunnel 連線到 Longhorn 的 Dashboard<sup><a href="#user-content-fn-longhorn-ui-access-6a8af0" id="user-content-fnref-longhorn-ui-access-6a8af0" data-footnote-ref="true" aria-describedby="footnote-label">2</a></sup>：</p>
<div class="language-shell codeBlockContainer_HtHN theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_XzDj"><pre tabindex="0" class="prism-code language-shell codeBlock_Kgad thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xOgw"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl port-forward \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    service/longhorn-frontend \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -n longhorn-system 3002:80 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --address 0.0.0.0</span><br></span></code></pre><div class="buttonGroup_PN__"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lePV" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_mz7K"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_aySJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/assets/images/03_longhorn-frontend-181644ffe13d8e290aad61e70bb1b0b7.webp" width="1440" height="923" class="img_RpFt"></p>
<section data-footnotes="true" class="footnotes"><h2 class="anchor anchorWithStickyNavbar_mpuI sr-only" id="footnote-label">Footnotes<a href="#footnote-label" class="hash-link" aria-label="Direct link to Footnotes" title="Direct link to Footnotes">​</a></h2>
<ol>
<li id="user-content-fn-longhorn-config-6a8af0">
<p>Longhorn | Documentation. Retrieved 2026-01-05, from <a href="https://longhorn.io/docs/1.10.1/advanced-resources/deploy/customizing-default-settings/" target="_blank" rel="noopener noreferrer">https://longhorn.io/docs/1.10.1/advanced-resources/deploy/customizing-default-settings/</a> <a href="#user-content-fnref-longhorn-config-6a8af0" data-footnote-backref="" aria-label="Back to reference 1" class="data-footnote-backref">↩</a></p>
</li>
<li id="user-content-fn-longhorn-ui-access-6a8af0">
<p>Longhorn 部署筆記 | 翠鳥圖書館 Project Halcyon Library. Retrieved 2026-01-05, from <a href="https://wiki.pha.pub/books/109-TAs/page/longhorn" target="_blank" rel="noopener noreferrer">https://wiki.pha.pub/books/109-TAs/page/longhorn</a> <a href="#user-content-fnref-longhorn-ui-access-6a8af0" data-footnote-backref="" aria-label="Back to reference 2" class="data-footnote-backref">↩</a></p>
</li>
</ol>
</section></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_Wp5O padding--none margin-left--sm"><li class="tag_UXKs"><a class="tag_lXMw tagRegular_c460" href="/posts/tags/k-8-s">k8s</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="接續我在前一篇貼文指出的：K8s 本身只是框架，並沒有包含 SDS (Software-defined storage) 的具體實作："><header><h2 class="title_BVkY" itemprop="headline"><a itemprop="url" href="/posts/2026-01-05_k8s-longhorn-intro">K8s 學習筆記 - Longhorn 簡介</a></h2><div class="container_sDB1 margin-vert--md"><time datetime="2026-01-05T00:00:00.000Z" itemprop="datePublished">January 5, 2026</time></div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_SrKl"><div class="avatar margin-bottom--sm"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/9475660" alt="Wei Ji" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/FlySkyPie" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Wei Ji</span></a></div><small class="avatar__subtitle" itemprop="description">閃亮症候群工程屍</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>接續我  在<a href="https://flyskypie.github.io/posts/2026-01-05_k8s-is-framework/" target="_blank" rel="noopener noreferrer">前一篇貼文</a>指出的：K8s 本身只是框架，並沒有包含 SDS (Software-defined storage) 的具體實作：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/01_storage-backend-e7a9cba39ddcedd48bddc96779f8936b.webp" width="1089" height="715" class="img_RpFt"></p>
<p><a href="https://github.com/longhorn/longhorn" target="_blank" rel="noopener noreferrer">Longhorn</a> 則是其中一種 SDS 實作：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/02_longhorn-1983f6aeeeb627c39461978dd959b7fe.webp" width="1089" height="715" class="img_RpFt"></p>
<p>Longhorn 巧妙的運用 K8s 作為基礎設施，將 SDS 運行在 Cluster 內部，並且利用 K8s 的多節點特性運行多個實例，並在多個實例上建立資料冗餘實現分散式副本：</p>
<p><img decoding="async" loading="lazy" src="/assets/images/03_longhorn-4e94a43f1813ec3e0cc932bd7e179964.webp" width="1040" height="802" class="img_RpFt"></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_Wp5O padding--none margin-left--sm"><li class="tag_UXKs"><a class="tag_lXMw tagRegular_c460" href="/posts/tags/k-8-s">k8s</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/posts"><div class="pagination-nav__label">Newer Entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/posts/page/3"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 FlyPie (Wei Ji)</div></div></div></footer></div>
</body>
</html>