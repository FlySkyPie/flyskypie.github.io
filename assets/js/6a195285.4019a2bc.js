"use strict";(self.webpackChunkflyskypie_github_io=self.webpackChunkflyskypie_github_io||[]).push([[6674],{68161:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var i=s(11527),t=s(88717);const r={slug:"2025-12-28_learn-k8s",authors:["weiji"],tags:["k8s"]},o="\u6559\u7df4\u6211\u60f3\u5b78 K8s",l={permalink:"/posts/2025-12-28_learn-k8s",source:"@site/post/2025-12-28_learn-k8s/index.md",title:"\u6559\u7df4\u6211\u60f3\u5b78 K8s",description:"\u6700\u8fd1\u60f3\u5b78 K8s \u7136\u5f8c\u9678\u7e8c\u628a Homelab \u7684\u670d\u52d9\u5f9e Docker Swarm \u79fb\u904e\u53bb\uff0c\u4e0d\u904e\u4e00\u76f4\u975c\u4e0d\u4e0b\u5fc3\u597d\u597d\u8b80\u5b83\uff0c\u601d\u7dd2\u7cca\u6210\u4e00\u5718\uff0c\u65bc\u662f\u60f3\u8aaa\u5148\u628a\u4e00\u4e9b\u5df2\u7d93\u77e5\u9053\u7684\u4e8b\u60c5\u6574\u7406\u4e00\u4e0b\u3002",date:"2025-12-28T00:00:00.000Z",formattedDate:"December 28, 2025",tags:[{label:"k8s",permalink:"/posts/tags/k-8-s"}],hasTruncateMarker:!1,authors:[{name:"Wei Ji",title:"\u9583\u4eae\u75c7\u5019\u7fa4\u5de5\u7a0b\u5c4d",url:"https://github.com/FlySkyPie",imageURL:"https://avatars.githubusercontent.com/u/9475660",key:"weiji"}],frontMatter:{slug:"2025-12-28_learn-k8s",authors:["weiji"],tags:["k8s"]},unlisted:!1,prevItem:{title:"\u5f9e Docker \u958b\u59cb\u7684 Systemd \u5c0f\u5b87\u5b99",permalink:"/posts/2025-12-29_systemd-ish"},nextItem:{title:"\u77e5\u8b58\u908a\u754c\u8207\u6211\u7684\u5c08\u984c\u5f0f\u81ea\u5b78\u6cd5",permalink:"/posts/2025-12-26_knowledge-boundary-and-project-based-learning"}},a={authorsImageUrls:[void 0]},c=[{value:"\u52d5\u6a5f",id:"\u52d5\u6a5f",level:2},{value:"Image Volume",id:"image-volume",level:3},{value:"<code>depends_on</code>",id:"depends_on",level:3},{value:"Serverless",id:"serverless",level:3},{value:"K3s \u8207\u9060\u7aef\u8a2a\u554f",id:"k3s-\u8207\u9060\u7aef\u8a2a\u554f",level:2},{value:"K8s \u67b6\u69cb\u5716",id:"k8s-\u67b6\u69cb\u5716",level:2},{value:"Kubernetes The Hard Way",id:"kubernetes-the-hard-way",level:2},{value:"\u6b63\u78ba\u6253\u958b K8s \u7684\u65b9\u5f0f...\u96e3\u9053\u662f\u5bc6\u78bc\u5b78\uff1f",id:"\u6b63\u78ba\u6253\u958b-k8s-\u7684\u65b9\u5f0f\u96e3\u9053\u662f\u5bc6\u78bc\u5b78",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",sup:"sup",ul:"ul",...(0,t.a)(),...e.components},{Head:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r,{children:(0,i.jsx)("meta",{property:"og:image",content:"https://raw.githubusercontent.com/FlySkyPie/flyskypie.github.io/main/post/2025-12-28_learn-k8s/00_cover.webp"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:s(66489).Z+"",width:"1024",height:"1024"})}),"\n",(0,i.jsx)(n.p,{children:"\u6700\u8fd1\u60f3\u5b78 K8s \u7136\u5f8c\u9678\u7e8c\u628a Homelab \u7684\u670d\u52d9\u5f9e Docker Swarm \u79fb\u904e\u53bb\uff0c\u4e0d\u904e\u4e00\u76f4\u975c\u4e0d\u4e0b\u5fc3\u597d\u597d\u8b80\u5b83\uff0c\u601d\u7dd2\u7cca\u6210\u4e00\u5718\uff0c\u65bc\u662f\u60f3\u8aaa\u5148\u628a\u4e00\u4e9b\u5df2\u7d93\u77e5\u9053\u7684\u4e8b\u60c5\u6574\u7406\u4e00\u4e0b\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u52d5\u6a5f",children:"\u52d5\u6a5f"}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"\u56e0\u70ba\u6211\u5be6\u969b\u4e0a\u9084\u672a\u5be6\u969b\u4f7f\u7528 K8s\uff0c\u6240\u4ee5\u4ee5\u4e0b\u53ef\u4ee5\u7576\u6210\u300c\u5c0d K8s \u7684\u7f8e\u597d\u5e7b\u60f3\u300d\u3002"})}),"\n",(0,i.jsx)(n.p,{children:"\u7c21\u55ae\u7d00\u9304\u4e00\u4e0b\u5e7e\u500b\u8b93\u6211\u60f3\u5b78 K8s \u7684\u52d5\u6a5f\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"image-volume",children:"Image Volume"}),"\n",(0,i.jsx)(n.p,{children:"\u524d\u4e00\u9663\u5b50\u5728\u9f13\u6417 Keyclaok\uff0c\u4e26\u4e14\u5916\u639b\u4e86\u5169\u500b\u7d44\u4ef6\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/keycloakify/keycloakify",children:"https://github.com/keycloakify/keycloakify"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/p2-inc/keycloak-magic-link",children:"https://github.com/p2-inc/keycloak-magic-link"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Keycloak \u7684\u63d2\u4ef6\u6a5f\u5236\u662f\u5c07 ",(0,i.jsx)(n.code,{children:"*.jar"})," \u6a94\u6848\u653e\u5230 ",(0,i.jsx)(n.code,{children:"/opt/keycloak/providers/"})," \u4e0b\uff0c\u5f85\u555f\u52d5\u6642\u88ab\u8f09\u5165\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u5728 OCI (Open Container Initiative) \u4f48\u7f72\u4e0b\u8655\u7406\u9019\u7a2e\u9019\u6574\u5408\u6709\u5169\u7a2e\u65b9\u6cd5\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5efa\u7f6e\u968e\u6bb5\uff1a\u76f4\u63a5\u5728 Dockerfile \u7528 COPY \u5b8c\u6210\u7d44\u88dd\u3002"}),"\n",(0,i.jsx)(n.li,{children:"\u4f48\u7f72\u968e\u6bb5\uff1a\u900f\u904e Volume \u5c07 jar \u6a94\u6848\u639b\u8f09\u9032\u5bb9\u5668\u3002"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u524d\u8005\u7f3a\u4e4f\u5f48\u6027\uff1b\u5f8c\u8005 Docker \u4e0d\u652f\u63f4\uff0c\u4f46\u662f K8s \u652f\u63f4",(0,i.jsx)(n.sup,{children:(0,i.jsx)(n.a,{href:"#user-content-fn-k8s-image-volume-135bb9",id:"user-content-fnref-k8s-image-volume-135bb9","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})}),"\u3002"]}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsxs)(n.p,{children:["\u8a71\u8aaa\u56de\u4f86\u9019\u5e7e\u5929\u5728\u8b80 Docker Compose \u7684 spec \u770b\u5230\u9019\u6771\u897f(",(0,i.jsx)(n.code,{children:"image"}),")\uff1a"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'// service.volumes.type\n  "type": {\n    "type": "string",\n    "enum": ["bind", "volume", "tmpfs", "cluster", "npipe", "image"],\n    "description": "The mount type: bind for mounting host directories, volume for named volumes, tmpfs for temporary filesystems, cluster for cluster volumes, npipe for named pipes, or image for mounting from an image."\n  },\n'})}),(0,i.jsx)(n.p,{children:"\u4e5f\u8a31 Docker \u4e5f\u652f\u63f4\u4e86\u8aaa\u4e0d\u5b9a\u3002"})]}),"\n",(0,i.jsx)(n.h3,{id:"depends_on",children:(0,i.jsx)(n.code,{children:"depends_on"})}),"\n",(0,i.jsxs)(n.p,{children:["Docker Compose \u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"depends_on"})," \u4f86\u5ef6\u9072\u4e00\u4e9b\u5bb9\u5668\u7684\u555f\u52d5\uff0c\u907f\u514d\u4ef0\u8cf4\u5176\u4ed6\u5bb9\u5668\u7684\u670d\u52d9\u904e\u65e9\u7684\u555f\u52d5\uff0c\u4f8b\u5982\uff1a\u5f8c\u7aef\u5617\u8a66\u5c0d\u9084\u6c92\u6e96\u5099\u5b8c\u6210\u7684\u8cc7\u6599\u5eab\u9032\u884c\u9023\u7dda\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"Docker Swarm \u5247\u4e0d\u652f\u63f4\u9019\u500b\u529f\u80fd\uff0c\u5b83\u7684\u908f\u8f2f\u662f\u900f\u904e health check\uff1a\u53cd\u6b63\u6709\u4ef0\u8cf4\u7684\u5bb9\u5668\u9023\u7dda\u5931\u6557\u6703 health check \u5931\u6557\uff0c\u76f4\u63a5\u91cd\u555f\u5bb9\u5668\u76f4\u5230\u6210\u529f\u70ba\u6b62\u3002\u4f46\u662f\u9019\u6a23\u7684\u8a2d\u8a08\u7121\u6cd5\u904b\u884c\u76f8\u5c0d\u8907\u96dc\u7684\u670d\u52d9\uff0c\u4f8b\u5982\uff1a\u6211\u5617\u8a66\u5728 Swarm \u6a21\u5f0f\u4e0b\u904b\u884c GVM (OpenVas) \u4e26\u6c92\u6709\u6210\u529f\u904e\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u800c K8s \u5247\u662f\u900f\u904e ",(0,i.jsx)(n.code,{children:"initContainers"})," \u7684\u6a5f\u5236\u4f86\u8655\u7406\u9019\u985e\u9700\u6c42\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"serverless",children:"Serverless"}),"\n",(0,i.jsx)(n.p,{children:"\u5de5\u4f5c\u6642\u4f7f\u7528\u96f2\u7aef\u7684 Serverless \u7684\u670d\u52d9 (GCP Cloud Run)\uff0c\u56e0\u6b64\u6211\u5c0d\u65bc\u81ea\u67b6 (selfhosted) \u65b9\u6848\u5f88\u611f\u8208\u8da3\uff0c\u4e5f\u6709\u627e\u5230\u4e00\u4e9b\u958b\u6e90\u65b9\u6848\uff0c\u4e0d\u904e\u5b83\u5011\u591a\u57fa\u65bc K8s\uff0c\u4f8b\u5982\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/fission/fission",children:"https://github.com/fission/fission"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/openfaas/faas",children:"https://github.com/openfaas/faas"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/knative/serving",children:"https://github.com/knative/serving"})}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:'\u6211\u9019\u88e1\u662f\u6307\u57fa\u65bc OCI \u7684 Serverless\uff0c\u975e OCI \u7684 "Function based" Serverless \u65b9\u6848\u901a\u5e38\u90fd\u6709\u7dca\u652f\u63f4\u7279\u5b9a\u7a0b\u5f0f\u8a9e\u8a00\u7684\u9650\u5236\u3002'})}),"\n",(0,i.jsx)(n.h2,{id:"k3s-\u8207\u9060\u7aef\u8a2a\u554f",children:"K3s \u8207\u9060\u7aef\u8a2a\u554f"}),"\n",(0,i.jsx)(n.p,{children:"\u524d\u5e7e\u5929 (2025-12-23) \u5b89\u88dd\u5b8c K3s \u8a2d\u5b9a\u9060\u7aef\u8a2a\u554f\u6642\u770b\u5230\u9019\u500b\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ kubectl config view\napiVersion: v1\nclusters:\n- cluster:\n    certificate-authority-data: DATA+OMITTED\n    server: https://127.0.0.1:6443\n  name: default\ncontexts:\n- context:\n    cluster: default\n    user: default\n  name: default\ncurrent-context: default\nkind: Config\npreferences: {}\nusers:\n- name: default\n  user:\n    client-certificate-data: DATA+OMITTED\n    client-key-data: DATA+OMITTED\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u96d6\u7136\u77e5\u9053 ",(0,i.jsx)(n.code,{children:"certificate-authority-data"})," \u5927\u6982\u662f\u70ba\u4e86 HTTPS \u7684\u52a0\u5bc6\u6a5f\u5236\u800c\u6e96\u5099\u7684\uff0c\u4e0d\u904e\u6211\u5176\u5be6\u4e0d\u77e5\u6240\u4ee5\u7136\u3002"]}),"\n",(0,i.jsx)(n.h2,{id:"k8s-\u67b6\u69cb\u5716",children:"K8s \u67b6\u69cb\u5716"}),"\n",(0,i.jsx)(n.p,{children:"\u67e5\u8cc7\u6599\u7684\u6642\u5019\u770b\u5230\u9019\u5f35\u67b6\u69cb\u5716\uff1a"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:s(39830).Z+"",width:"1602",height:"2010"})}),"\n",(0,i.jsx)(n.p,{children:"\u6211\u6ce8\u610f\u5230 K8s \u7684\u7d44\u4ef6\u4e4b\u9593\u901a\u8a0a\u90fd\u662f\u52a0\u5bc6\u7684\uff0c\u9019\u8b93\u6211\u60f3\u5230\u4e4b\u524d\u900f\u904e\u300cKubernetes The Hard Way\u300d\u5b78\u7fd2 K8s \u7684\u7d93\u9a57\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u4ee5\u53ca\u67d0\u7bc7\u6587\u7ae0\uff0c\u6709\u500b\u8001\u5144\u62b1\u6028 K8s \u96e3\u7528\uff0c\u4f3a\u670d\u5668\u7671\u7613\u7684\u539f\u56e0\u4f3c\u4e4e\u662f\u6191\u8b49\u904e\u671f\uff0c\u4e26\u4e14\u5b83\u5011\u6700\u5f8c\u5728 AWS \u627e\u5230\u4e86\u6b78\u5c6c\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"kubernetes-the-hard-way",children:"Kubernetes The Hard Way"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://github.com/kelseyhightower/kubernetes-the-hard-way",children:"Kubernetes The Hard Way"})," \u662f\u4e00\u500b\u67b6\u8a2d K8s \u7684\u6559\u5b78\uff0c\u4f46\u662f\u4e0d\u4f7f\u7528\u73fe\u6210\u7684\u5b89\u88dd\u7cbe\u9748\uff0c\u800c\u662f\u624b\u52d5\u5b89\u88dd\u8207\u914d\u7f6e\u6bcf\u4e00\u500b\u7d44\u4ef6\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u53bb\u5e74\uff082024 \u5e74 1 \u6708\uff09\u6211\u5176\u5be6\u8a66\u8457\u4f9d\u7167\u9019\u4efd\u6307\u5357\u7684\u6b65\u9a5f\u5617\u8a66\u5728\u4e00\u53f0 x86 32 \u4f4d\u5143\u7b46\u96fb\u4e0a\u5efa\u7acb K8s\uff0c\u96d6\u7136\u6700\u5f8c\u6c92\u6709\u6301\u7e8c\u4e0b\u53bb\uff0c\u4f46\u662f\u6211\u96b1\u7d04\u8a18\u5f97\u904e\u7a0b\u4e2d\u4e00\u76f4\u5728\u751f\u6210\u91d1\u9470\u8ddf\u7c3d\u7f72\u6191\u8b49\u3002"}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsx)(n.p,{children:"\u6211\u7576\u6642\u6709\u8a66\u8457\u5c07\u57f7\u884c\u904e\u5f97\u6b65\u9a5f\u5beb\u6210 Make/Ansible \u8173\u672c\uff1a"}),(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/FlySkyPie/k8s-builder-and-installer-for-x86-single-node",children:"https://github.com/FlySkyPie/k8s-builder-and-installer-for-x86-single-node"})})]}),"\n",(0,i.jsx)(n.h2,{id:"\u6b63\u78ba\u6253\u958b-k8s-\u7684\u65b9\u5f0f\u96e3\u9053\u662f\u5bc6\u78bc\u5b78",children:"\u6b63\u78ba\u6253\u958b K8s \u7684\u65b9\u5f0f...\u96e3\u9053\u662f\u5bc6\u78bc\u5b78\uff1f"}),"\n",(0,i.jsx)(n.p,{children:"\u4f5c\u70ba\u4e00\u500b\u4ee5\u958b\u767c\u524d\u7aef\u696d\u52d9\u908f\u8f2f\u70ba\u91cd\u5fc3\u7684\u958b\u767c\u8005\uff0c\u5bc6\u78bc\u5b78\u76f8\u95dc\u7684\u57fa\u790e\u6982\u5ff5\u53ef\u4ee5\u8aaa\u662f\u5f88\u5bb9\u6613\u88ab\u8f15\u5ffd\u7684\u90e8\u4efd\u3002\u6216\u8a31\u6211\u8a72\u597d\u597d\u7684\u68b3\u7406\u4ee5\u4e0b\u5c0d\u65bc\u52a0\u5bc6\u6280\u8853\u7684\u57fa\u790e\u6982\u5ff5\u4f5c\u70ba\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u7576\u7136\uff0c\u5982\u679c\u6211\u53ea\u662f\u8981\u4f5c\u70ba K8s \u7684\u4f7f\u7528\u8005\uff0c\u9019\u4e9b\u77e5\u8b58\u4f3c\u4e4e\u6c92\u6709\u9019\u9ebc\u91cd\u8981\uff0c\u4e0d\u904e\u6211\u540c\u6642\u9084\u662f\u8981\u5728 Homelab \u67b6\u8a2d K8s \u7684\u7dad\u8b77\u8005\uff0c\u6211\u4e0d\u8a8d\u70ba\u7d2e\u7d2e\u6642\u6642\u7684\u628a\u57fa\u790e\u6253\u597d\u6709\u4ec0\u9ebc\u58de\u8655\u3002"}),"\n",(0,i.jsxs)(n.section,{"data-footnotes":!0,className:"footnotes",children:[(0,i.jsx)(n.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{id:"user-content-fn-k8s-image-volume-135bb9",children:["\n",(0,i.jsxs)(n.p,{children:["Use an Image Volume With a Pod | Kubernetes. ",(0,i.jsx)(n.a,{href:"https://kubernetes.io/docs/tasks/configure-pod-container/image-volumes/",children:"https://kubernetes.io/docs/tasks/configure-pod-container/image-volumes/"})," ",(0,i.jsx)(n.a,{href:"#user-content-fnref-k8s-image-volume-135bb9","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},66489:(e,n,s)=>{s.d(n,{Z:()=>i});const i=s.p+"assets/images/00_cover-cad795c3aa51f3adfc9ccdba21a8cf5e.webp"},39830:(e,n,s)=>{s.d(n,{Z:()=>i});const i=s.p+"assets/images/01_k8s-eb9afbe14a7063a5e37bbb93a531086e.webp"},88717:(e,n,s)=>{s.d(n,{Z:()=>l,a:()=>o});var i=s(50959);const t={},r=i.createContext(t);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);